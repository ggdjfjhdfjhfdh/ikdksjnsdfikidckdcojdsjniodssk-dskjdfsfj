document.addEventListener("DOMContentLoaded",function(){window.mobileSystem=new class{constructor(){this.currentPanel="map",this.isMobile=window.innerWidth<=1024,this.threatData=null,this.templates={stats:this.createStatsTemplate.bind(this),attacks:this.createAttacksTemplate.bind(this)}}init(){console.log("🚀 Iniciando sistema de navegación por pestañas"),this.setupEventListeners(),this.loadDataFromDesktop(),this.isMobile&&this.hideDesktopElements(),this.switchPanel("map")}setupEventListeners(){document.querySelectorAll(".nav-tab").forEach(n=>{n.addEventListener("touchstart",e=>{navigator.vibrate&&navigator.vibrate(10),n.style.transform="translateY(0) scale(0.95)"},{passive:!0}),n.addEventListener("touchend",e=>{setTimeout(()=>{n.classList.contains("active")||(n.style.transform="")},100)},{passive:!0}),n.addEventListener("click",n=>{n.preventDefault();const e=n.currentTarget.dataset.panel;navigator.vibrate&&navigator.vibrate([20,10,20]),this.createRippleEffect(n.currentTarget,n),this.switchPanel(e)})}),document.querySelectorAll(".close-panel").forEach(n=>{n.addEventListener("click",n=>{navigator.vibrate&&navigator.vibrate(15),this.switchPanel("map")})}),window.addEventListener("resize",()=>{this.handleResize()})}createRippleEffect(n,e){const t=document.createElement("span"),a=n.getBoundingClientRect(),i=Math.max(a.width,a.height),s=e.clientX-a.left-i/2,o=e.clientY-a.top-i/2;t.style.cssText=`\n          position: absolute;\n          width: ${i}px;\n          height: ${i}px;\n          left: ${s}px;\n          top: ${o}px;\n          background: rgba(255, 255, 255, 0.3);\n          border-radius: 50%;\n          transform: scale(0);\n          animation: ripple 0.6s ease-out;\n          pointer-events: none;\n          z-index: 1;\n        `,n.style.position="relative",n.style.overflow="hidden",n.appendChild(t),setTimeout(()=>{t.remove()},600)}switchPanel(n){if(console.log(`📱 Cambiando a panel: ${n}`),document.querySelectorAll(".nav-tab").forEach(e=>{e.classList.toggle("active",e.dataset.panel===n)}),document.querySelectorAll(".mobile-panel").forEach(n=>{n.classList.remove("active")}),"map"!==n){const e=document.querySelector(`.${n}-panel`);e&&(e.classList.add("active"),this.loadPanelContent(n))}this.currentPanel=n}loadDataFromDesktop(){console.log("🔄 Intentando cargar datos desde escritorio..."),console.log("🔍 window.threatDataUpdater disponible:",!!window.threatDataUpdater),console.log("🔍 window.threatMapProps disponible:",!!window.threatMapProps),window.threatDataUpdater?.lastDataCache?(this.threatData=window.threatDataUpdater.lastDataCache,console.log("📊 Datos cargados desde threatDataUpdater:",this.threatData)):window.threatMapProps?.threatData?(this.threatData=window.threatMapProps.threatData,console.log("📊 Datos cargados desde threatMapProps:",this.threatData)):(console.warn("⚠️ No se encontraron datos de escritorio, usando datos de ejemplo"),this.threatData={})}loadPanelContent(n){const e=document.getElementById(`mobile${n.charAt(0).toUpperCase()+n.slice(1)}Content`);e&&this.templates[n]&&(e.innerHTML="",e.innerHTML=this.templates[n](),this.applyPanelStyles(e,n),setTimeout(()=>{e.classList.add("content-loaded")},50))}applyPanelStyles(n,e){switch(n.classList.add("panel-content-loaded"),e){case"stats":this.applyStatsStyles(n);break;case"attacks":this.applyAttacksStyles(n)}n.offsetHeight}applyStatsStyles(n){n.querySelectorAll(".metric-card").forEach((n,e)=>{n.style.animationDelay=.1*e+"s",n.classList.add("metric-card-animated")});n.querySelectorAll(".country-bar-fill").forEach((n,e)=>{setTimeout(()=>{n.style.width=n.getAttribute("data-width")||n.style.width},200+100*e)});n.querySelectorAll(".growth-bar-fill").forEach((n,e)=>{setTimeout(()=>{n.style.width=n.getAttribute("data-width")||n.style.width},400+100*e)})}applyAttacksStyles(n){n.querySelectorAll(".attack-item").forEach((n,e)=>{n.style.animationDelay=.1*e+"s",n.classList.add("attack-item-animated")})}createStatsTemplate(){const n=window.threatMapProps?.threatData||{};if(!n||0===Object.keys(n).length)return'<div class="error">Cargando datos reales...</div>';const e=n.urlhaus?.count||0,t=n.malwarebazaar?.count||0,a=n.ransomwatch?.count||0,i=e+t+a+(n.cloudflare?.topAttackPairs?.length?n.cloudflare.topAttackPairs.reduce((n,e)=>n+(e.attacks||0),0):0),s=Math.floor(.15*i),o=a+Math.floor(.1*t),r=Math.floor(.73*i);return`\n          <div class="stats-content-enhanced">\n            \x3c!-- SECCIÓN 1: ESTADO GENERAL DEL SISTEMA --\x3e\n            \n            \x3c!-- SECCIÓN 2: MÉTRICAS PRINCIPALES --\x3e\n            <div class="stats-section-group metrics-overview visual-accent">\n              <div class="section-group-header">\n                <div class="header-content">\n                  <i class="fas fa-chart-bar"></i>\n                  <h2>Métricas Principales</h2>\n                </div>\n                <div class="header-actions">\n                  \n                \n                 \n                </div>\n              </div>\n              \n              <div class="section-content">\n                <div class="metrics-grid-enhanced">\n                  <div class="metric-card-enhanced primary">\n                    <div class="metric-icon">\n                      <i class="fas fa-shield-alt"></i>\n                    </div>\n                    <div class="metric-content">\n                      <div class="metric-label">Total Amenazas Detectadas</div>\n                      <div class="metric-value">\n                        ${i.toLocaleString()}\n                        <span class="metric-trend">\n                          <i class="fas fa-minus"></i>\n                          N/A\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                  \n                  <div class="metric-card-enhanced critical">\n                    <div class="metric-icon">\n                      <i class="fas fa-exclamation-triangle"></i>\n                    </div>\n                    <div class="metric-content">\n                      <div class="metric-label">Amenazas Críticas</div>\n                      <div class="metric-value">\n                        ${o.toLocaleString()}\n                        <span class="metric-trend">\n                          <i class="fas fa-minus"></i>\n                          N/A\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                  \n                  <div class="metric-card-enhanced success">\n                    <div class="metric-icon">\n                      <i class="fas fa-shield-check"></i>\n                    </div>\n                    <div class="metric-content">\n                      <div class="metric-label">Amenazas Bloqueadas</div>\n                      <div class="metric-value">\n                        ${r.toLocaleString()}\n                        <span class="metric-trend">\n                          <i class="fas fa-minus"></i>\n                          N/A\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                  \n                  <div class="metric-card-enhanced warning">\n                    <div class="metric-icon">\n                      <i class="fas fa-bolt"></i>\n                    </div>\n                    <div class="metric-content">\n                      <div class="metric-label">Amenazas Activas</div>\n                      <div class="metric-value">\n                        ${s.toLocaleString()}\n                        <span class="metric-trend">\n                          <i class="fas fa-minus"></i>\n                          N/A\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            \x3c!-- Separador Visual --\x3e\n            <div class="section-divider-enhanced">\n              <div class="divider-icon">\n                <i class="fas fa-globe-americas"></i>\n              </div>\n            </div>\n\n            \x3c!-- SECCIÓN 3: ANÁLISIS GEOGRÁFICO Y TEMPORAL --\x3e\n            <div class="stats-section-group analysis-section visual-accent">\n              <div class="section-group-header">\n                <div class="header-content">\n                  <i class="fas fa-globe-americas"></i>\n                  <h2>Análisis Geográfico y Temporal</h2>\n                </div>\n                <div class="header-actions">\n                  <span class="section-badge">\n                    <i class="fas fa-map"></i>\n                    195 países\n                  </span>\n                  <button class="action-btn" title="Vista detallada">\n                    <i class="fas fa-expand"></i>\n                  </button>\n                </div>\n              </div>\n              \n              <div class="section-content">\n                <div class="analysis-grid">\n                  \x3c!-- Distribución Geográfica --\x3e\n                  <div class="analysis-card geographic">\n                    <div class="card-header">\n                      <h3>Distribución Geográfica</h3>\n                      <button class="view-all-btn">Ver Todo</button>\n                    </div>\n                    <div class="card-content">\n                      ${this.renderTopCountriesEnhanced()}\n                    </div>\n                  </div>\n                  \n       \n\n            \x3c!-- SECCIÓN 4: CLASIFICACIÓN DE AMENAZAS --\x3e\n            <div class="stats-section-group threat-classification visual-accent">\n              <div class="section-group-header">\n                <div class="header-content">\n                  <i class="fas fa-virus"></i>\n                  <h2>Clasificación de Amenazas</h2>\n                </div>\n                <div class="header-meta">\n                  <span class="section-badge">\n                    <i class="fas fa-shield-virus"></i>\n                    4 tipos\n                  </span>\n                </div>\n              </div>\n              \n              <div class="section-content">\n                <div class="threat-types-enhanced">\n                  <div class="threat-type-card malware">\n                    <div class="threat-type-header">\n                      <div class="threat-type-icon">\n                        <i class="fas fa-bug"></i>\n                      </div>\n                      <div class="threat-type-info">\n                        <h4>Malware</h4>\n                        <span class="threat-percentage">45.2%</span>\n                      </div>\n                    </div>\n                    <div class="threat-type-progress">\n                      <div class="progress-track">\n                        <div class="progress-fill malware" style="width: 45.2%"></div>\n                      </div>\n                      <span class="progress-label">Predominante</span>\n                    </div>\n                  </div>\n                  \n                  <div class="threat-type-card phishing">\n                    <div class="threat-type-header">\n                      <div class="threat-type-icon">\n                        <i class="fas fa-fish"></i>\n                      </div>\n                      <div class="threat-type-info">\n                        <h4>Phishing</h4>\n                        <span class="threat-percentage">28.7%</span>\n                      </div>\n                    </div>\n                    <div class="threat-type-progress">\n                      <div class="progress-track">\n                        <div class="progress-fill phishing" style="width: 28.7%"></div>\n                      </div>\n                      <span class="progress-label">Alto</span>\n                    </div>\n                  </div>\n                  \n                  <div class="threat-type-card ransomware">\n                    <div class="threat-type-header">\n                      <div class="threat-type-icon">\n                        <i class="fas fa-lock"></i>\n                      </div>\n                      <div class="threat-type-info">\n                        <h4>Ransomware</h4>\n                        <span class="threat-percentage">15.8%</span>\n                      </div>\n                    </div>\n                    <div class="threat-type-progress">\n                      <div class="progress-track">\n                        <div class="progress-fill ransomware" style="width: 15.8%"></div>\n                      </div>\n                      <span class="progress-label">Medio</span>\n                    </div>\n                  </div>\n                  \n                  <div class="threat-type-card botnet">\n                    <div class="threat-type-header">\n                      <div class="threat-type-icon">\n                        <i class="fas fa-network-wired"></i>\n                      </div>\n                      <div class="threat-type-info">\n                        <h4>Botnet</h4>\n                        <span class="threat-percentage">10.3%</span>\n                      </div>\n                    </div>\n                    <div class="threat-type-progress">\n                      <div class="progress-track">\n                        <div class="progress-fill botnet" style="width: 10.3%"></div>\n                      </div>\n                      <span class="progress-label">Bajo</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        `}createAttacksTemplate(){if(!this.threatData)return console.warn("🚨 No hay threatData disponible en createAttacksTemplate"),'<div class="error">No hay datos disponibles</div>';const n=this.generateRecentAttacks();console.log("📊 Ataques generados para timeline móvil:",n.length,n);const e=this.calculateAttackStats(n);return`\n          <div class="attacks-content-enhanced">\n            \x3c!-- SECCIÓN 1: RESUMEN DE ACTIVIDAD --\x3e\n            <div class="stats-section-group activity-overview visual-accent">\n              <div class="section-group-header">\n                <div class="header-content">\n                  <i class="fas fa-bolt"></i>\n                  <h2>Actividad en Tiempo Real</h2>\n                </div>\n                <div class="header-meta">\n                  <span class="section-badge">\n                    <i class="fas fa-fire"></i>\n                    Alta Actividad\n                  </span>\n                  <span class="update-indicator">\n                    <i class="fas fa-circle pulse"></i>\n                    Actualizado hace 30s\n                  </span>\n                </div>\n              </div>\n              \n              <div class="section-content">\n                <div class="activity-summary-enhanced">\n                  <div class="activity-metric-card critical">\n                    <div class="metric-icon">\n                      <i class="fas fa-exclamation-triangle"></i>\n                    </div>\n                    <div class="metric-content">\n                      <div class="metric-label">Ataques Activos</div>\n                      <div class="metric-value">\n                        ${e.active||127}\n                        <span class="metric-trend">\n                          <i class="fas fa-arrow-up"></i>\n                          +12%\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                  \n                  <div class="activity-metric-card success">\n                    <div class="metric-icon">\n                      <i class="fas fa-shield-alt"></i>\n                    </div>\n                    <div class="metric-content">\n                      <div class="metric-label">Ataques Bloqueados</div>\n                      <div class="metric-value">\n                        ${e.blocked||2456}\n                        <span class="metric-trend">\n                          <i class="fas fa-arrow-up"></i>\n                          +8%\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            \x3c!-- Separador Visual --\x3e\n            <div class="section-divider-enhanced">\n              <div class="divider-icon">\n                <i class="fas fa-clock"></i>\n              </div>\n            </div>\n\n            \x3c!-- SECCIÓN 2: TIMELINE DE ATAQUES --\x3e\n            <div class="stats-section-group timeline-section visual-accent">\n              <div class="section-group-header">\n                <div class="header-content">\n                  <i class="fas fa-history"></i>\n                  <h2>Timeline de Ataques</h2>\n                </div>\n                <div class="header-actions">\n                  <span class="section-badge">\n                    <i class="fas fa-clock"></i>\n                    Últimas 24h\n                  </span>\n                  <button class="action-btn auto-refresh-btn active" title="Auto-refresh activo">\n                    <i class="fas fa-sync-alt"></i>\n                  </button>\n                  <button class="action-btn" title="Configurar alertas">\n                    <i class="fas fa-bell"></i>\n                  </button>\n                </div>\n              </div>\n              \n              <div class="section-content">\n                <div class="timeline-container-enhanced">\n                  ${this.renderAttacksTimeline(n)}\n                </div>\n              </div>\n            </div>\n          </div>\n        `}renderTopCountries(){return(this.threatData.cloudflare?.topCountries||[{code:"US",value:.25,name:"Estados Unidos"},{code:"CN",value:.18,name:"China"},{code:"RU",value:.15,name:"Rusia"},{code:"DE",value:.12,name:"Alemania"},{code:"GB",value:.1,name:"Reino Unido"}]).slice(0,5).map((n,e)=>{const t=Math.round(100*(n.value||0)),a=Math.floor(1e5*(n.value||0));return`\n            <div class="country-item">\n              <div class="country-header">\n                <div class="country-info">\n                  <div class="country-flag">${n.code}</div>\n                  <span class="country-name">${n.name}</span>\n                </div>\n                <span class="country-percentage">${t}%</span>\n              </div>\n              <div class="country-bar">\n                <div class="country-bar-fill" style="width: ${t}%"></div>\n              </div>\n              <div class="country-attacks">${a.toLocaleString()} ataques detectados</div>\n            </div>\n          `}).join("")}renderTopCountriesEnhanced(){const n=window.threatMapProps?.threatData||{},e=n.cloudflare?.topCountries||[],t={US:{flag:"🇺🇸",name:"Estados Unidos"},CN:{flag:"🇨🇳",name:"China"},RU:{flag:"🇷🇺",name:"Rusia"},DE:{flag:"🇩🇪",name:"Alemania"},GB:{flag:"🇬🇧",name:"Reino Unido"},FR:{flag:"🇫🇷",name:"Francia"},IN:{flag:"🇮🇳",name:"India"},JP:{flag:"🇯🇵",name:"Japón"},BR:{flag:"🇧🇷",name:"Brasil"},CA:{flag:"🇨🇦",name:"Canadá"}};return e.slice(0,5).map((n,a)=>{const i=n.code||n.name?.substring(0,2).toUpperCase()||"XX",s=t[i]||{flag:"🏳️",name:n.name||"País Desconocido"},o=n.attacks||n.count||0,r=e.reduce((n,e)=>n+(e.attacks||e.count||0),0),c=a<2?12+3*a:-(2+a),l=c>0?`+${c}%`:`${c}%`;let d="low";return o>5e3?d="critical":o>2e3?d="high":o>500&&(d="medium"),{code:i,value:r>0?o/r:0,name:s.name,flag:s.flag,trend:l,severity:d,lastAttack:5*(a+1)+" min",attacks:o}}).slice(0,5).map((n,e)=>{const t=Math.round(100*(n.value||0)),a=Math.floor(1e5*(n.value||0)),i=n.trend.startsWith("+")?"up":"down";return`\n            <div class="country-item-enhanced">\n              <div class="country-rank">#${e+1}</div>\n              <div class="country-main">\n                <div class="country-header-enhanced">\n                  <div class="country-info-enhanced">\n                    <span class="country-flag-enhanced">${n.flag}</span>\n                    <div class="country-details">\n                      <span class="country-name-enhanced">${n.name}</span>\n                      <span class="country-code">${n.code}</span>\n                    </div>\n                  </div>\n                  <div class="country-metrics">\n                    <span class="country-percentage-enhanced">${t}%</span>\n                    <span class="country-trend ${i}">${n.trend}</span>\n                  </div>\n                </div>\n                <div class="country-progress-enhanced">\n                  <div class="country-bar-enhanced">\n                    <div class="country-bar-fill-enhanced ${n.severity}" style="width: ${t}%"></div>\n                  </div>\n                  <div class="country-stats-row">\n                    <span class="country-attacks-enhanced">${a.toLocaleString()} ataques</span>\n                    <span class="country-last-attack">Último: ${n.lastAttack}</span>\n                  </div>\n                </div>\n              </div>\n              <div class="country-severity-indicator ${n.severity}">\n                <i class="fas fa-circle"></i>\n              </div>\n            </div>\n          `}).join("")}renderGrowthRates(){return[{label:"Malware",rate:"+15%",trend:"up",color:"#ef4444"},{label:"Phishing",rate:"+8%",trend:"up",color:"#f59e0b"},{label:"DDoS",rate:"-3%",trend:"down",color:"#22c55e"},{label:"Ransomware",rate:"+22%",trend:"up",color:"#dc2626"}].map(n=>`\n          <div class="growth-item">\n            <div class="growth-header">\n              <span class="growth-label">${n.label}</span>\n              <span class="growth-rate ${n.trend}" style="color: ${n.color}">\n                ${"up"===n.trend?"↗":"↘"} ${n.rate}\n              </span>\n            </div>\n            <div class="growth-bar">\n              <div class="growth-bar-fill" style="background: ${n.color}; width: ${Math.abs(parseInt(n.rate))}%"></div>\n            </div>\n          </div>\n        `).join("")}getAttackIcon(n){const e={malware:"🦠",phishing:"🎣",ransomware:"🔒",ddos:"⚡",botnet:"🤖",default:"⚠️"};return e[n]||e.default}getSeverityLabel(n){return{critical:"Crítica",high:"Alta",medium:"Media",low:"Baja"}[n]||"Media"}generateRecentAttacks(){const n=window.threatMapProps?.threatData||{};console.log("🔍 threatData disponible en generateRecentAttacks:",n),console.log("📊 URLhaus data:",n.urlhaus?.recent_samples?.length||0,"samples"),console.log("🔒 RansomWatch data:",n.ransomwatch?.rawData?.recentPosts?.length||0,"posts"),console.log("🤖 FeodoTracker data:",n.feodotracker?.recentBotnets?.length||0,"botnets"),console.log("🛡️ Cloudflare data:",n.cloudflare?.topAttackPairs?.length||0,"pairs");const e={US:{name:"Estados Unidos",flag:"🇺🇸"},CN:{name:"China",flag:"🇨🇳"},RU:{name:"Rusia",flag:"🇷🇺"},DE:{name:"Alemania",flag:"🇩🇪"},GB:{name:"Reino Unido",flag:"🇬🇧"},FR:{name:"Francia",flag:"🇫🇷"},BR:{name:"Brasil",flag:"🇧🇷"},IN:{name:"India",flag:"🇮🇳"},JP:{name:"Japón",flag:"🇯🇵"},CA:{name:"Canadá",flag:"🇨🇦"}},t=[];n.urlhaus?.recent_samples&&n.urlhaus.recent_samples.forEach((n,a)=>{if(!n.host)return;const i=n.country||"XX",s=e[i]||{name:n.country||"Desconocido",flag:"🏳️"};t.push({id:`urlhaus_${a}`,type:"malware",title:`URL maliciosa: ${n.url_status||"detectada"}`,country:s.name,countryCode:i,flag:s.flag,severity:"malware_download"===n.threat?"critical":"high",timestamp:new Date(n.date_added||Date.now()-45e3*a).getTime(),minutesAgo:n.date_added?Math.floor((Date.now()-new Date(n.date_added).getTime())/6e4):Math.floor(.75*a),ip:n.host,port:n.port||80,blocked:"offline"===n.url_status,source:"URLhaus"})}),n.ransomwatch?.rawData?.recentPosts&&n.ransomwatch.rawData.recentPosts.forEach((n,a)=>{if(!n.group_name&&!n.victim)return;const i=n.country||"XX",s=e[i]||{name:n.country||"Desconocido",flag:"🏳️"};t.push({id:`ransomwatch_${a}`,type:"ransomware",title:`Ransomware: ${n.group_name||"Grupo desconocido"} - ${n.victim||"Víctima"}`,country:s.name,countryCode:i,flag:s.flag,severity:"critical",timestamp:new Date(n.discovered||Date.now()).getTime(),minutesAgo:Math.floor((Date.now()-new Date(n.discovered||Date.now()).getTime())/6e4),ip:n.website||n.leak_site||null,port:443,blocked:"offline"===n.status||"down"===n.status,source:"Ransomwatch"})}),n.feodotracker?.recentBotnets&&n.feodotracker.recentBotnets.slice(0,5).forEach((n,a)=>{const i=n.country||"XX",s=e[i]||{name:n.country||"Desconocido",flag:"🏳️"};t.push({id:`botnet_${a}`,type:"botnet",title:`Servidor C&C: ${n.malware||"Botnet"} detectado`,country:s.name,countryCode:i,flag:s.flag,severity:"online"===n.status?"high":"medium",timestamp:new Date(n.first_seen||Date.now()-12e4*a).getTime(),minutesAgo:Math.floor((Date.now()-new Date(n.first_seen||Date.now()-12e4*a).getTime())/6e4),ip:n.ip_address||`botnet-${a}`,port:n.port||443,blocked:"offline"===n.status,source:"FeodoTracker",malware:n.malware})}),n.cloudflare?.topAttackPairs&&(console.log("🌍 Datos de países de Cloudflare:",n.cloudflare.topAttackPairs.slice(0,3).map(n=>({origin:n.origin_country,target:n.target_country,sourceCountry:n.sourceCountry,targetCountry:n.targetCountry}))),n.cloudflare.topAttackPairs.slice(0,10).forEach((n,a)=>{const i=n.origin_country||n.sourceCountry||"Origen desconocido",s=n.target_country||n.targetCountry||"Destino desconocido",o=e[i]||{name:i,flag:"🏳️"},r=e[s]||{name:s},c=n.attacks||n.requests||n.attackCount||0;t.push({id:`cloudflare_${a}`,type:"ddos",title:`Ataque DDoS: ${o.name} → ${r.name}`,country:o.name,countryCode:i,flag:o.flag,severity:c>1e3?"critical":c>500?"high":"medium",timestamp:Date.now()-3e4*a,minutesAgo:Math.floor(.5*a),ip:`${i}-to-${s}`,port:80,blocked:Math.random()>.3,source:"Cloudflare",attackCount:c,originCountry:i,targetCountry:s})}));const a=t.filter(n=>n.ip&&null!==n.ip);console.log("📊 Total de ataques generados:",t.length),console.log("📊 Ataques válidos (con IP):",a.length);const i=a.sort((n,e)=>e.timestamp-n.timestamp);return console.log("📊 Primeros 5 ataques ordenados por fecha:",i.slice(0,5).map(n=>({type:n.type,title:n.title.substring(0,50)+"...",minutesAgo:n.minutesAgo,timestamp:new Date(n.timestamp).toLocaleTimeString()}))),i}calculateAttackStats(n){return{total:n.length,blocked:n.filter(n=>n.blocked).length,active:n.filter(n=>!n.blocked).length,critical:n.filter(n=>"critical"===n.severity).length}}renderAttacksTimeline(n){return console.log("🎯 renderAttacksTimeline recibió:",n?.length||0,"ataques"),n&&0!==n.length?n.slice(0,15).map((n,e)=>`\n          <div class="timeline-item ${n.severity}" data-type="${n.type}">\n            <div class="timeline-time">${this.formatTimeAgo(n.minutesAgo)}</div>\n            <div class="timeline-content">\n              <div class="attack-header">\n                <div class="attack-type-badge ${n.type}">\n                  ${this.getAttackIcon(n.type)}\n                  <span>${n.type.toUpperCase()}</span>\n                </div>\n                <div class="attack-status ${n.blocked?"blocked":"active"}">\n                  <i class="fas fa-${n.blocked?"shield-check":"exclamation-triangle"}"></i>\n                  ${n.blocked?"BLOQUEADO":"ACTIVO"}\n                </div>\n              </div>\n              <div class="attack-title">${n.title}</div>\n              <div class="attack-details">\n                <span class="attack-location">\n                  ${n.flag} ${n.country}\n                </span>\n                <span class="attack-ip">${n.ip}:${n.port}</span>\n              </div>\n            </div>\n            <div class="timeline-severity ${n.severity}">\n              <i class="fas fa-circle"></i>\n            </div>\n          </div>\n        `).join(""):'<div class="timeline-empty">No hay ataques recientes para mostrar</div>'}renderAttackHeatmap(){return Array.from({length:24},(n,e)=>{const t=e>=8&&e<=18?70+e%3*10:30+e%4*5;return`\n            <div class="heatmap-cell ${t>80?"very-high":t>60?"high":t>40?"medium":t>20?"low":"very-low"}" data-hour="${e}" data-intensity="${t}">\n              <span class="hour-label">${e.toString().padStart(2,"0")}:00</span>\n              <span class="intensity-value">${t}</span>\n            </div>\n          `}).join("")}renderAttackVectors(){return[{name:"Email",percentage:45,trend:"+12%",icon:"envelope"},{name:"Web",percentage:32,trend:"+8%",icon:"globe"},{name:"Red",percentage:15,trend:"-3%",icon:"network-wired"},{name:"USB",percentage:5,trend:"+2%",icon:"usb"},{name:"Otros",percentage:3,trend:"0%",icon:"ellipsis-h"}].map(n=>`\n          <div class="vector-item">\n            <div class="vector-icon">\n              <i class="fas fa-${n.icon}"></i>\n            </div>\n            <div class="vector-info">\n              <div class="vector-name">${n.name}</div>\n              <div class="vector-stats">\n                <span class="vector-percentage">${n.percentage}%</span>\n                <span class="vector-trend ${n.trend.startsWith("+")?"up":n.trend.startsWith("-")?"down":"neutral"}">\n                  ${n.trend}\n                </span>\n              </div>\n            </div>\n            <div class="vector-bar">\n              <div class="vector-fill" style="width: ${n.percentage}%"></div>\n            </div>\n          </div>\n        `).join("")}formatTimeAgo(n){if(n<1)return"Ahora";if(n<60)return`${n}m`;return`${Math.floor(n/60)}h`}renderThreatTypeFilters(){const n=window.threatMapProps?.threatData||{},e=n.malwarebazaar?.count||0;return[{id:"malware",name:"Malware",count:e,icon:"bug",color:"#e74c3c"},{id:"phishing",name:"Phishing",count:n.urlhaus?.count||0,icon:"fish",color:"#f39c12"},{id:"ransomware",name:"Ransomware",count:n.ransomwatch?.count||0,icon:"lock",color:"#8e44ad"},{id:"ddos",name:"DDoS",count:n.cloudflare?.topAttackPairs?.length?n.cloudflare.topAttackPairs.reduce((n,e)=>n+(e.attacks||0),0):0,icon:"tachometer-alt",color:"#e67e22"},{id:"botnet",name:"Botnet",count:n.cloudflare?.topCountries?.length?n.cloudflare.topCountries.reduce((n,e)=>n+(e.attacks||0),0):0,icon:"network-wired",color:"#34495e"},{id:"trojan",name:"Troyano",count:Math.floor(.3*e),icon:"horse-head",color:"#c0392b"}].map(n=>`\n          <div class="filter-option">\n            <label class="filter-checkbox">\n              <input type="checkbox" value="${n.id}" checked>\n              <span class="checkmark"></span>\n              <div class="filter-info">\n                <div class="filter-icon" style="color: ${n.color}">\n                  <i class="fas fa-${n.icon}"></i>\n                </div>\n                <div class="filter-details">\n                  <span class="filter-name">${n.name}</span>\n                  <span class="filter-count">${n.count.toLocaleString()} amenazas</span>\n                </div>\n              </div>\n            </label>\n          </div>\n        `).join("")}renderSeverityFilters(){const n=window.threatMapProps?.threatData||{},e=(n.urlhaus?.count||0)+(n.malwarebazaar?.count||0)+(n.ransomwatch?.count||0)+(n.cloudflare?.topCountries?.reduce((n,e)=>n+(e.attacks||e.count||0),0)||0),t=Math.floor(.15*e),a=Math.floor(.25*e),i=Math.floor(.4*e),s=e-t-a-i;return[{id:"critical",name:"Crítica",count:t,color:"#e74c3c",percentage:Math.round(t/e*100)||15},{id:"high",name:"Alta",count:a,color:"#f39c12",percentage:Math.round(a/e*100)||25},{id:"medium",name:"Media",count:i,color:"#f1c40f",percentage:Math.round(i/e*100)||40},{id:"low",name:"Baja",count:s,color:"#27ae60",percentage:Math.round(s/e*100)||20}].map(n=>`\n          <div class="filter-option severity-option">\n            <label class="filter-checkbox">\n              <input type="checkbox" value="${n.id}" checked>\n              <span class="checkmark"></span>\n              <div class="filter-info">\n                <div class="severity-indicator" style="background-color: ${n.color}"></div>\n                <div class="filter-details">\n                  <span class="filter-name">${n.name}</span>\n                  <span class="filter-count">${n.count} (${n.percentage}%)</span>\n                </div>\n              </div>\n            </label>\n            <div class="severity-bar">\n              <div class="severity-fill" style="width: ${n.percentage}%; background-color: ${n.color}"></div>\n            </div>\n          </div>\n        `).join("")}renderLocationFilters(){const n=window.threatMapProps?.threatData||{},e=n.cloudflare?.topCountries||[],t={US:{flag:"🇺🇸",region:"América del Norte"},CN:{flag:"🇨🇳",region:"Asia"},RU:{flag:"🇷🇺",region:"Europa/Asia"},DE:{flag:"🇩🇪",region:"Europa"},GB:{flag:"🇬🇧",region:"Europa"},BR:{flag:"🇧🇷",region:"América del Sur"},FR:{flag:"🇫🇷",region:"Europa"},IN:{flag:"🇮🇳",region:"Asia"},JP:{flag:"🇯🇵",region:"Asia"},KR:{flag:"🇰🇷",region:"Asia"},CA:{flag:"🇨🇦",region:"América del Norte"},AU:{flag:"🇦🇺",region:"Oceanía"}};return`\n          <div class="location-search">\n            <input type="text" placeholder="Buscar país..." class="location-search-input">\n          </div>\n          <div class="location-list">\n            ${e.slice(0,10).map(n=>{const e=n.code||n.name?.substring(0,2).toUpperCase()||"XX",a=t[e]||{flag:"🏳️",region:"Desconocido"};return{id:e.toLowerCase(),name:n.name||"País Desconocido",count:n.attacks||n.count||0,flag:a.flag,region:a.region}}).map(n=>`\n              <div class="filter-option location-option">\n                <label class="filter-checkbox">\n                  <input type="checkbox" value="${n.id}">\n                  <span class="checkmark"></span>\n                  <div class="filter-info">\n                    <div class="location-flag">${n.flag}</div>\n                    <div class="filter-details">\n                      <span class="filter-name">${n.name}</span>\n                      <span class="filter-region">${n.region}</span>\n                      <span class="filter-count">${n.count.toLocaleString()} amenazas</span>\n                    </div>\n                  </div>\n                </label>\n              </div>\n            `).join("")}\n          </div>\n        `}renderTimeFilters(){const n=window.threatMapProps?.threatData||{},e=(n.urlhaus?.count||0)+(n.malwarebazaar?.count||0)+(n.ransomwatch?.count||0)+(n.cloudflare?.topCountries?.reduce((n,e)=>n+(e.attacks||e.count||0),0)||0);return`\n          <div class="time-range-options">\n            ${[{id:"1h",name:"Última hora",count:Math.floor(.05*e),active:!0},{id:"6h",name:"Últimas 6 horas",count:Math.floor(.15*e),active:!1},{id:"24h",name:"Últimas 24 horas",count:Math.floor(.3*e),active:!1},{id:"7d",name:"Últimos 7 días",count:Math.floor(.7*e),active:!1},{id:"30d",name:"Últimos 30 días",count:e,active:!1}].map(n=>`\n              <div class="time-range-option ${n.active?"active":""}">\n                <input type="radio" name="timeRange" value="${n.id}" ${n.active?"checked":""}>\n                <label>\n                  <span class="time-name">${n.name}</span>\n                  <span class="time-count">${n.count.toLocaleString()} amenazas</span>\n                </label>\n              </div>\n            `).join("")}\n          </div>\n          <div class="custom-time-range">\n            <h5>Rango Personalizado</h5>\n            <div class="date-inputs">\n              <input type="datetime-local" class="date-input" placeholder="Desde">\n              <input type="datetime-local" class="date-input" placeholder="Hasta">\n            </div>\n          </div>\n        `}renderProtectionFilters(){const n=window.threatMapProps?.threatData||{},e=(n.urlhaus?.count||0)+(n.malwarebazaar?.count||0)+(n.ransomwatch?.count||0)+(n.cloudflare?.topCountries?.reduce((n,e)=>n+(e.attacks||e.count||0),0)||0);return[{id:"blocked",name:"Bloqueado",count:Math.floor(.75*e),icon:"shield-check",color:"#27ae60"},{id:"active",name:"Activo",count:Math.floor(.15*e),icon:"exclamation-triangle",color:"#e74c3c"},{id:"monitoring",name:"En Monitoreo",count:Math.floor(.05*e),icon:"eye",color:"#f39c12"},{id:"resolved",name:"Resuelto",count:Math.floor(.05*e),icon:"check-circle",color:"#3498db"}].map(n=>`\n          <div class="filter-option protection-option">\n            <label class="filter-checkbox">\n              <input type="checkbox" value="${n.id}" ${"blocked"===n.id?"checked":""}>\n              <span class="checkmark"></span>\n              <div class="filter-info">\n                <div class="protection-icon" style="color: ${n.color}">\n                  <i class="fas fa-${n.icon}"></i>\n                </div>\n                <div class="filter-details">\n                  <span class="filter-name">${n.name}</span>\n                  <span class="filter-count">${n.count} amenazas</span>\n                </div>\n              </div>\n            </label>\n          </div>\n        `).join("")}formatTime(n){if(!n)return"Hace un momento";const e=new Date-new Date(n),t=Math.floor(e/6e4),a=Math.floor(e/36e5),i=Math.floor(e/864e5);return t<1?"Ahora":t<60?`Hace ${t}m`:a<24?`Hace ${a}h`:`Hace ${i}d`}handleResize(){const n=window.innerWidth<=1024;n!==this.isMobile&&(this.isMobile=n,this.isMobile?this.hideDesktopElements():this.showDesktopElements())}hideDesktopElements(){document.querySelectorAll(".desktop-only, .right-panel").forEach(n=>{n.style.display="none"})}showDesktopElements(){document.querySelectorAll(".desktop-only, .right-panel").forEach(n=>{n.style.display=""})}},window.mobileSystem.init(),console.log("✅ Sistema móvil mejorado inicializado")});class n{constructor(){this.updateInterval=null,this.notificationQueue=[]}init(){this.updateTabIndicators(),this.startRealTimeUpdates(),this.setupNotificationStyles(),console.log("🔔 Sistema de indicadores inicializado")}updateTabIndicators(){document.querySelectorAll(".nav-tab").forEach(n=>{const e=n.getAttribute("data-panel")||n.getAttribute("data-tab");if(!e)return;const t=n.querySelector(".status-indicator"),a=n.querySelector(".notification-badge");t&&t.remove(),a&&a.remove();const i=this.getTabStatus(e),s=this.getTabNotifications(e);if(i&&"normal"!==i){const e=document.createElement("div");e.className=`status-indicator ${i}`,n.appendChild(e)}if(s>0){const e=document.createElement("div");e.className="notification-badge",e.textContent=s>99?"99+":s,n.appendChild(e)}})}getTabStatus(n){return{stats:this.getCurrentThreatLevel(),attacks:this.getAttackStatus(),filters:"normal"}[n]||"normal"}getTabNotifications(n){return{stats:0,attacks:this.getActiveAttacksCount(),filters:this.getActiveFiltersCount()}[n]||0}getCurrentThreatLevel(){const n=this.getActiveAttacksCount();return n>50?"critical":n>20||n>5?"warning":"safe"}getAttackStatus(){const n=this.getActiveAttacksCount();return n>10?"critical":n>5?"warning":"safe"}getActiveAttacksCount(){const n=window.threatMapProps?.threatData||{},e=(n.urlhaus?.count||0)+(n.ransomwatch?.count||0)+(n.malwarebazaar?.count||0),t=Math.floor(.05*e);return Math.max(t,0)}getActiveFiltersCount(){return document.querySelectorAll(".filter-checkbox input:checked").length||2}startRealTimeUpdates(){this.updateInterval=setInterval(()=>{this.updateTabIndicators();const n=this.getActiveAttacksCount();n>25&&this.showNotification("¡Alerta de Seguridad!",`Se han detectado ${n} ataques activos`,"critical")},12e4),setInterval(()=>{this.refreshMetrics()},3e5)}showNotification(n,e,t="info"){const a=`${n}-${t}`;if(this.notificationQueue.includes(a))return;this.notificationQueue.push(a);const i=document.createElement("div");i.className=`system-notification ${t}`,i.innerHTML=`\n        <div class="notification-header">\n          <strong>${n}</strong>\n          <button class="notification-close" onclick="this.parentElement.parentElement.remove()">×</button>\n        </div>\n        <div class="notification-message">${e}</div>\n      `,document.body.appendChild(i),setTimeout(()=>{i.parentElement&&(i.style.animation="slideIn 0.3s ease-out reverse",setTimeout(()=>{i.remove();const n=this.notificationQueue.indexOf(a);n>-1&&this.notificationQueue.splice(n,1)},300))},5e3)}setupNotificationStyles(){if(document.querySelector("#notification-styles"))return;const n=document.createElement("style");n.id="notification-styles",n.textContent="\n        .system-notification {\n          position: fixed;\n          top: 20px;\n          right: 20px;\n          background: rgba(15, 23, 42, 0.95);\n          border: 1px solid rgba(255, 255, 255, 0.1);\n          border-radius: 12px;\n          padding: 16px;\n          max-width: 350px;\n          z-index: 10000;\n          backdrop-filter: blur(20px);\n          animation: slideIn 0.3s ease-out;\n          box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);\n        }\n        \n        .system-notification.critical {\n          border-color: rgba(239, 68, 68, 0.4);\n          background: rgba(239, 68, 68, 0.1);\n        }\n        \n        .system-notification.warning {\n          border-color: rgba(245, 158, 11, 0.4);\n          background: rgba(245, 158, 11, 0.1);\n        }\n        \n        .notification-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          margin-bottom: 8px;\n          color: #ffffff;\n        }\n        \n        .notification-close {\n          background: none;\n          border: none;\n          color: rgba(255, 255, 255, 0.6);\n          font-size: 1.2rem;\n          cursor: pointer;\n          padding: 0;\n          width: 20px;\n          height: 20px;\n          transition: color 0.3s ease;\n        }\n        \n        .notification-close:hover {\n          color: rgba(255, 255, 255, 0.9);\n        }\n        \n        .notification-message {\n          color: rgba(226, 232, 240, 0.8);\n          font-size: 0.9rem;\n          line-height: 1.4;\n        }\n        \n        @keyframes slideIn {\n          from { transform: translateX(100%); opacity: 0; }\n          to { transform: translateX(0); opacity: 1; }\n        }\n        \n        @media (max-width: 768px) {\n          .system-notification {\n            top: 10px;\n            right: 10px;\n            left: 10px;\n            max-width: none;\n          }\n        }\n\n        /* Estilos Mejorados con Glass Effect y Tipografía */\n        .metrics-grid-enhanced,\n        .activity-summary-enhanced,\n        .quick-filters-enhanced {\n          display: grid;\n          grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n          gap: 1.5rem;\n          padding: 1.5rem;\n          background: linear-gradient(135deg, \n            rgba(255,255,255,0.08) 0%, \n            rgba(255,255,255,0.03) 50%,\n            rgba(255,255,255,0.01) 100%);\n          border-radius: 20px;\n          border: 1px solid rgba(255,255,255,0.12);\n          backdrop-filter: blur(20px);\n          box-shadow: \n            0 8px 32px rgba(0,0,0,0.12),\n            inset 0 1px 0 rgba(255,255,255,0.1);\n        }\n\n        .metric-card-enhanced,\n        .activity-metric-card,\n        .filter-option-card {\n          display: flex;\n          align-items: center;\n          gap: 1.2rem;\n          padding: 1.5rem;\n          background: linear-gradient(135deg, \n            rgba(255,255,255,0.06) 0%, \n            rgba(255,255,255,0.02) 100%);\n          border-radius: 16px;\n          border: 1px solid rgba(255,255,255,0.1);\n          backdrop-filter: blur(15px);\n          transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n          position: relative;\n          overflow: hidden;\n          cursor: pointer;\n        }\n\n        .metric-card-enhanced:hover,\n        .activity-metric-card:hover,\n        .filter-option-card:hover {\n          transform: translateY(-4px) scale(1.02);\n          box-shadow: \n            0 20px 40px rgba(0,0,0,0.15),\n            0 0 0 1px rgba(255,255,255,0.2),\n            inset 0 1px 0 rgba(255,255,255,0.15);\n          border-color: rgba(255,255,255,0.2);\n          background: linear-gradient(135deg, \n            rgba(255,255,255,0.1) 0%, \n            rgba(255,255,255,0.04) 100%);\n        }\n\n        .metric-icon,\n        .filter-icon {\n          width: 52px;\n          height: 52px;\n          border-radius: 14px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          font-size: 1.3rem;\n          color: white;\n          background: linear-gradient(135deg, var(--metric-color), var(--metric-color-light));\n          box-shadow: \n            0 8px 24px rgba(0,0,0,0.2),\n            inset 0 1px 0 rgba(255,255,255,0.2);\n          flex-shrink: 0;\n          position: relative;\n          overflow: hidden;\n        }\n\n        .metric-icon::before,\n        .filter-icon::before {\n          content: '';\n          position: absolute;\n          top: -50%;\n          left: -50%;\n          width: 200%;\n          height: 200%;\n          background: linear-gradient(45deg, transparent, rgba(255,255,255,0.15), transparent);\n          transform: rotate(45deg) translateX(-100%);\n          transition: transform 0.8s ease;\n        }\n\n        .metric-card-enhanced:hover .metric-icon::before,\n        .activity-metric-card:hover .metric-icon::before,\n        .filter-option-card:hover .filter-icon::before {\n          transform: rotate(45deg) translateX(100%);\n        }\n\n        .metric-content,\n        .filter-content {\n          flex: 1;\n          min-width: 0;\n        }\n\n        .metric-label,\n        .filter-label {\n          font-size: 0.95rem;\n          color: rgba(255,255,255,0.85);\n          margin-bottom: 0.4rem;\n          font-weight: 600;\n          letter-spacing: 0.025em;\n          text-transform: uppercase;\n          font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;\n        }\n\n        .metric-value,\n        .filter-value {\n          font-size: 1.6rem;\n          font-weight: 800;\n          color: white;\n          margin-bottom: 0.3rem;\n          display: flex;\n          align-items: center;\n          gap: 0.6rem;\n          font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;\n          letter-spacing: -0.02em;\n        }\n\n        .metric-trend,\n        .filter-status {\n          display: inline-flex;\n          align-items: center;\n          gap: 0.3rem;\n          padding: 0.3rem 0.7rem;\n          border-radius: 8px;\n          font-size: 0.8rem;\n          font-weight: 700;\n          background: linear-gradient(135deg, \n            rgba(255,255,255,0.15) 0%, \n            rgba(255,255,255,0.08) 100%);\n          color: rgba(255,255,255,0.95);\n          border: 1px solid rgba(255,255,255,0.1);\n          backdrop-filter: blur(10px);\n          text-transform: uppercase;\n          letter-spacing: 0.05em;\n        }\n\n        /* Colores específicos para cada tipo */\n        .metric-card-enhanced.primary,\n        .activity-metric-card.primary,\n        .filter-option-card.primary {\n          --metric-color: #3b82f6;\n          --metric-color-light: #60a5fa;\n        }\n\n        .metric-card-enhanced.critical,\n        .activity-metric-card.critical,\n        .filter-option-card.critical {\n          --metric-color: #ef4444;\n          --metric-color-light: #f87171;\n        }\n\n        .metric-card-enhanced.success,\n        .activity-metric-card.success,\n        .filter-option-card.success {\n          --metric-color: #10b981;\n          --metric-color-light: #34d399;\n        }\n\n        .metric-card-enhanced.warning,\n        .activity-metric-card.warning,\n        .filter-option-card.warning {\n          --metric-color: #f59e0b;\n          --metric-color-light: #fbbf24;\n        }\n\n        /* Estado activo para filtros */\n        .filter-option-card.active {\n          background: linear-gradient(135deg, \n            rgba(59, 130, 246, 0.15) 0%, \n            rgba(59, 130, 246, 0.05) 100%);\n          border-color: rgba(59, 130, 246, 0.3);\n          box-shadow: \n            0 0 0 1px rgba(59, 130, 246, 0.2),\n            0 8px 32px rgba(59, 130, 246, 0.1);\n        }\n\n        /* ===== TIPOGRAFÍA JERÁRQUICA PROFESIONAL ===== */\n        \n        /* Títulos principales (H1) */\n        h1, .main-title {\n          font-family: 'Segoe UI', 'Roboto', -apple-system, BlinkMacSystemFont, sans-serif;\n          font-weight: 600;\n          font-size: 2.4rem; /* 20% mayor que el texto normal (2rem base) */\n          color: #2C3E50;\n          letter-spacing: -0.02em;\n          line-height: 1.2;\n          margin-bottom: 1.5rem;\n        }\n\n        /* Títulos secundarios (H2) */\n        h2, .section-title, .section-group-header h2 {\n          font-family: 'Segoe UI', 'Roboto', -apple-system, BlinkMacSystemFont, sans-serif;\n          font-weight: 600;\n          font-size: 2rem; /* 20% mayor que el texto normal */\n          color: #34495E;\n          letter-spacing: -0.015em;\n          line-height: 1.3;\n          margin-bottom: 1.25rem;\n          position: relative;\n        }\n\n        /* Títulos terciarios (H3) */\n        h3, .subsection-title, .subsection-header h3 {\n          font-family: 'Segoe UI', 'Roboto', -apple-system, BlinkMacSystemFont, sans-serif;\n          font-weight: 600;\n          font-size: 1.6rem; /* 20% mayor que el texto normal */\n          color: #34495E;\n          letter-spacing: -0.01em;\n          line-height: 1.4;\n          margin-bottom: 1rem;\n        }\n\n        /* Texto normal base */\n        body, p, .normal-text {\n          font-family: 'Segoe UI', 'Roboto', -apple-system, BlinkMacSystemFont, sans-serif;\n          font-size: 1rem;\n          color: #2C3E50;\n          line-height: 1.6;\n        }\n\n        /* Estilos específicos para secciones con fondo oscuro */\n        .stats-section-group h2,\n        .panel-content h2,\n        .dark-section h2 {\n          color: #FFFFFF;\n          text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);\n        }\n\n        .stats-section-group h3,\n        .panel-content h3,\n        .dark-section h3 {\n          color: #F8F9FA;\n          text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);\n        }\n\n        /* Badges y etiquetas */\n        .section-badge {\n          font-family: 'Segoe UI', 'Roboto', -apple-system, BlinkMacSystemFont, sans-serif;\n          font-weight: 600;\n          font-size: 0.8rem;\n          letter-spacing: 0.05em;\n          text-transform: uppercase;\n          color: #7F8C8D;\n        }\n\n        /* Títulos de tarjetas */\n        .card-title, .metric-card h3, .dashboard-card h3 {\n          font-family: 'Segoe UI', 'Roboto', -apple-system, BlinkMacSystemFont, sans-serif;\n          font-weight: 600;\n          font-size: 1.4rem;\n          color: #2C3E50;\n          margin-bottom: 0.75rem;\n        }\n\n        /* Títulos en contexto oscuro */\n        .dark-context .card-title,\n        .dark-context h3 {\n          color: #FFFFFF;\n        }\n\n        /* ===== RESPONSIVIDAD Y ACCESIBILIDAD ===== */\n        \n        /* Mejoras de accesibilidad */\n        .nav-tab:focus,\n        .section-header:focus,\n        .panel-header:focus {\n          outline: 2px solid #3498DB;\n          outline-offset: 2px;\n          box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.2);\n        }\n        \n        /* Reducir movimiento para usuarios con preferencias de accesibilidad */\n        @media (prefers-reduced-motion: reduce) {\n          .nav-tab,\n          .stats-section-group,\n          .metric-card,\n          .attack-item {\n            transition: none;\n            animation: none;\n          }\n        }\n        \n        /* Alto contraste para mejor legibilidad */\n        @media (prefers-contrast: high) {\n          h1, h2, h3, .main-title, .section-title {\n            color: #000000;\n            text-shadow: none;\n          }\n          \n          .nav-tab {\n            border: 2px solid #000000;\n          }\n          \n          .nav-tab.active {\n            background: #000000;\n            color: #FFFFFF;\n          }\n        }\n\n        /* Responsive para tablets */\n        @media (max-width: 1024px) {\n          h1, .main-title {\n            font-size: 2rem;\n          }\n          \n          h2, .section-title {\n            font-size: 1.6rem;\n          }\n          \n          h3, .subsection-title {\n            font-size: 1.4rem;\n          }\n          \n          .nav-tab {\n            padding: 14px 18px;\n            font-size: 1rem;\n            min-width: 70px;\n          }\n          \n          .stats-section-group {\n            margin-bottom: 20px;\n          }\n        }\n\n        /* Responsive */\n        @media (max-width: 768px) {\n          /* Tipografía responsive */\n          h1, .main-title {\n            font-size: 1.8rem;\n          }\n          \n          h2, .section-title {\n            font-size: 1.4rem;\n          }\n          \n          h3, .subsection-title {\n            font-size: 1.2rem;\n          }\n          \n          /* Pestañas responsive */\n          .nav-tabs {\n            flex-wrap: wrap;\n            gap: 4px;\n          }\n          \n          .nav-tab {\n            padding: 12px 16px;\n            font-size: 0.9rem;\n            min-width: 60px;\n            min-height: 56px;\n          }\n          \n          /* Espaciado responsive */\n          .stats-section-group {\n            margin-bottom: 16px;\n          }\n          \n          .metric-card, .attack-item, .filter-group, .country-item {\n            margin-bottom: 16px;\n          }\n          \n          .section-content > *:not(:last-child) {\n            margin-bottom: 16px;\n          }\n          \n          /* Íconos más pequeños en móvil */\n          .section-header::before,\n          .subsection-header::before,\n          .panel-header::before {\n            width: 14px;\n            height: 14px;\n            background-size: 14px 14px;\n          }\n        }\n        \n        /* Responsive para móviles pequeños */\n        @media (max-width: 480px) {\n          h1, .main-title {\n            font-size: 1.6rem;\n          }\n          \n          h2, .section-title {\n            font-size: 1.3rem;\n          }\n          \n          h3, .subsection-title {\n            font-size: 1.1rem;\n          }\n          \n          .nav-tab {\n            padding: 10px 12px;\n            font-size: 0.85rem;\n            min-width: 50px;\n            min-height: 48px;\n          }\n          \n          .stats-section-group {\n            margin-bottom: 12px;\n          }\n        }\n          .metrics-grid-enhanced,\n          .activity-summary-enhanced,\n          .quick-filters-enhanced {\n            grid-template-columns: 1fr;\n            gap: 1rem;\n            padding: 1rem;\n          }\n          \n          .metric-card-enhanced,\n          .activity-metric-card,\n          .filter-option-card {\n            padding: 1.2rem;\n            gap: 1rem;\n          }\n          \n          .metric-value,\n          .filter-value {\n            font-size: 1.4rem;\n          }\n        }\n\n        /* Responsive para gráficos horizontales */\n        @media (max-width: 768px) {\n          .horizontal-metrics-container {\n            padding: 1rem;\n            gap: 1rem;\n          }\n\n          .horizontal-metric-item {\n            flex-direction: column;\n            align-items: flex-start;\n            gap: 0.75rem;\n          }\n\n          .metric-info-horizontal {\n            width: 100%;\n          }\n\n          .horizontal-bar-container {\n            width: 100%;\n            order: 3;\n          }\n\n          .metric-percentage-horizontal {\n            order: 4;\n            text-align: left;\n          }\n        }\n      ",document.head.appendChild(n)}refreshMetrics(){window.mobileSystem&&window.mobileSystem.currentPanel&&window.mobileSystem.loadPanelContent(window.mobileSystem.currentPanel),window.threatDataUpdater&&window.threatDataUpdater.updateThreatData()}destroy(){this.updateInterval&&clearInterval(this.updateInterval),document.querySelectorAll(".system-notification").forEach(n=>n.remove());const n=document.querySelector("#notification-styles");n&&n.remove()}}document.addEventListener("DOMContentLoaded",()=>{window.tabIndicatorSystem=new n,window.tabIndicatorSystem.init()});
